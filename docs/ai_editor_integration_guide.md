# AIエディタ組み込みガイド for 誰でも作家life

## 1. はじめに

このドキュメントは、小説投稿プラットフォーム「誰でも作家life」（以下、dsaku-life）にAIエディタ機能を組み込む開発を担当するAI開発エージェント向けのガイドです。
dsaku-lifeの既存システムを理解し、スムーズかつ効果的にAIエディタを統合することを目的とします。

## 2. dsaku-life システム概要

dsaku-lifeは、誰もが小説を執筆し、投稿し、閲覧できるコミュニティプラットフォームです。主な機能として、小説の作成・編集、エピソード管理、公開設定、ユーザー間の交流（フォロー、ブックマーク、いいね、コメント）などがあります。

AIエディタは、特に以下の領域でユーザーの執筆体験を向上させる可能性があります。

*   **小説執筆支援**: 文章校正、表現の提案、アイデア発想支援など。
*   **プロット作成支援**: 構成案の生成、キャラクター設定の補助など。
*   **世界観構築支援**: 設定の矛盾チェック、関連情報の提示など。

開発ドキュメントの `docs/README.md` には、システム全体の開発計画やガイドラインが記載されています。また、`docs/model_reference.md` にはデータモデルの詳細が、`docs/api_documentation_index.md` には各種APIドキュメントへのポインタが含まれています。

## 3. AIエディタ組み込みの基本方針

### 3.1. 組み込み対象機能

主に以下の機能へのAIエディタの組み込みを検討します。

*   **小説執筆画面 (`/write`)**: メインとなる組み込み先。リアルタイムまたはオンデマンドでの執筆支援機能を提供します。
*   **プロット・設定管理機能**: （もし既存機能としてあれば）プロットやキャラクター、世界観設定の作成・編集を支援します。なければ新規機能としての検討も視野に入れます。

### 3.2. 既存システムへの影響

*   既存の小説執筆フローやUI/UXを尊重し、AI機能を自然な形で統合します。
*   AI機能のON/OFFや、提案の受け入れ/拒否など、ユーザーが主体的にAI支援を選択できるインターフェースを目指します。
*   パフォーマンスへの影響を最小限に抑えるため、特にリアルタイム支援の場合は処理の軽量化や非同期処理を検討します。

## 4. 技術的検討事項

### 4.1. API連携

dsaku-lifeのAPI仕様は `docs/api_documentation_index.md` から各詳細ドキュメントを参照してください。

*   **既存APIの活用**:
    *   小説本文や設定情報の取得・保存には、既存の小説執筆関連API（例: `docs/api_novel_writing.md` で定義されているもの）を活用します。
    *   `docs/api_authentication_required.md` によると、執筆関連のAPIは認証が必要です。AIエディタ機能も同様に適切な認証・認可制御下に置きます。
*   **AIエディタ用API**:
    *   AI処理（文章解析、提案生成など）を実行するためのバックエンドAPIを新規に設計・開発する必要があります。
    *   リクエスト：執筆中のテキスト、ユーザーの設定（支援レベルなど）、コンテキスト情報（小説ジャンル、キャラクター設定など）。
    *   レスポンス：校正結果、提案内容、生成されたテキストなど。
    *   API設計は、dsaku-lifeの既存APIの設計思想（RESTful、JSON形式など）を踏襲します。

### 4.2. データ連携

*   **入力データ**: ユーザーが執筆中のテキスト、選択範囲、関連するプロットやキャラクター情報などをAI処理APIに渡します。
*   **出力データ**: AIからの提案や修正案をユーザーに提示し、ユーザーが選択した場合に本文に反映します。AIが生成した内容を直接保存するか、ユーザーの編集を経て保存するかは機能要件によります。
*   **データ形式**: テキストデータはプレーンテキストまたはMarkdown形式が想定されます。既存の小説データ形式に準拠します。

### 4.3. フロントエンド組み込み

*   **UIコンポーネント**:
    *   AI提案を表示するサイドパネル、ポップアップ、インラインハイライトなど。
    *   AI機能設定用のモーダルやドロップダウンメニュー。
*   **イベント処理**:
    *   テキスト変更、カーソル移動、特定キー入力などをトリガーとしたAI機能の発火。
    *   AIからのレスポンスを非同期で受け取り、UIに反映。
*   **技術スタック**: dsaku-lifeのフロントエンド技術スタック（例: React, Next.jsなど、現状のプロジェクト構成に基づく）に合わせて実装します。

### 4.4. バックエンド処理

*   **AI処理ロジック**:
    *   自然言語処理ライブラリや外部AIサービスAPIを利用した文章解析、生成処理。
    *   ユーザーごとのコンテキストや設定に基づいたパーソナライズ。
*   **非同期タスク**:
    *   時間のかかるAI処理は非同期タスク（例: Celery、dsaku-lifeの `docs/batch_processing.md` や `docs/publish_schedule_implementation.md` でCeleryの使用が示唆されていればそれに倣う）として実行し、ユーザーの操作をブロックしないようにします。
    *   処理結果はWebSocketやポーリングなどでフロントエンドに通知します。
*   **AIモデル/サービス**:
    *   利用するAIモデルやAPIサービスを選定します（例: OpenAI API, Google AI Platformなど）。
    *   APIキーなどの認証情報は安全に管理します。

## 5. 開発ステップ例

1.  **調査・設計フェーズ**:
    *   dsaku-lifeのコードベース、特に執筆機能周りの詳細調査。
    *   AIエディタの具体的な機能要件定義とUI/UX設計。
    *   APIインターフェース設計。
2.  **バックエンド開発**:
    *   AI処理ロジックの実装。
    *   AIエディタ用APIエンドポイントの開発。
    *   非同期処理基盤の構築（必要に応じて）。
3.  **フロントエンド開発**:
    *   AIエディタ用UIコンポーネントの実装。
    *   バックエンドAPIとの連携処理。
4.  **テスト・PoC**:
    *   主要なAI支援機能（例:誤字脱字チェック、簡単な表現提案）に絞ったPoC版を開発し、使用感を検証。
5.  **段階的リリース**:
    *   基本的な機能から順にリリースし、ユーザーフィードバックを元に改善。
    *   より高度なAI機能（プロット生成支援など）を順次追加。

## 6. 注意点とベストプラクティス

*   **セキュリティ**:
    *   AI処理APIへのアクセスはdsaku-lifeの認証基盤を利用し、不正アクセスを防ぎます。
    *   ユーザーが入力するテキストデータは機密情報として扱い、適切に保護します。外部AIサービスを利用する場合は、そのサービスのセキュリティポリシーを確認します。
*   **パフォーマンス**:
    *   AI処理のレスポンスタイムを短縮し、ユーザー体験を損なわないようにします。
    *   クライアントサイドでの負荷、サーバーサイドでの負荷を考慮し、最適化を行います。
*   **エラーハンドリング**:
    *   AI処理のエラー（APIエラー、タイムアウト、予期せぬ結果など）を適切にハンドリングし、ユーザーに分かりやすく伝えます。
*   **ユーザー体験 (UX)**:
    *   AIの提案はあくまで支援であり、ユーザーの創造性を阻害しないように配慮します。
    *   AI機能が過度に邪魔にならないよう、表示方法やタイミングを調整します。
    *   AI機能の利用方法に関するチュートリアルやヘルプを提供します。
*   **ドキュメント更新**:
    *   AIエディタ機能に関する設計書、API仕様書、テストケースなどを整備し、dsaku-lifeの既存ドキュメント体系 (`docs/`以下) に追加します。

## 7. 参考ドキュメント (dsaku-life内)

*   `docs/README.md`: プロジェクト全体の概要と開発ガイドライン。
*   `docs/api_documentation_index.md`: APIドキュメントの目次。
*   `docs/api_authentication_required.md`: 認証が必要なAPIの一覧。
*   `docs/model_reference.md`: データモデルの詳細。
*   (想定) `docs/api_novel_writing.md`: 小説執筆関連APIの詳細。

このガイドが、dsaku-lifeへのAIエディタ組み込みプロジェクトの成功に繋がることを期待しています。
